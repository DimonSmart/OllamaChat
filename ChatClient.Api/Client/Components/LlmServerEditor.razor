@using ChatClient.Domain.Models

<MudTextField @bind-Value="Server.Name"
              Label="Server Name"
              Required="true"
              Immediate="true" />

<MudSelect T="ServerType" @bind-Value="Server.ServerType" Label="Server Type" Class="mt-4">
    <MudSelectItem Value="ServerType.Ollama">Ollama</MudSelectItem>
    <MudSelectItem Value="ServerType.ChatGpt">ChatGPT</MudSelectItem>
</MudSelect>

<MudTextField @bind-Value="Server.BaseUrl"
              Label="Base URL"
              Variant="Variant.Outlined"
              Class="mt-4"
              Required="@(Server.ServerType == ServerType.Ollama)"
              HelperText="@GetBaseUrlHelperText()" />

@if (Server.ServerType == ServerType.ChatGpt)
{
    <MudTextField @bind-Value="Server.ApiKey"
                  Label="API Key"
                  Variant="Variant.Outlined"
                  Class="mt-4"
                  Required="true"
                  InputType="InputType.Password"
                  HelperText="OpenAI API key (required)" />
}

@if (Server.ServerType == ServerType.Ollama)
{
    <MudTextField @bind-Value="Server.Password"
                  Label="Password"
                  Variant="Variant.Outlined"
                  InputType="InputType.Password"
                  Class="mt-4"
                  HelperText="Optional password for Ollama server" />
}

<MudNumericField T="int" @bind-Value="Server.HttpTimeoutSeconds"
                 Label="HTTP Timeout (seconds)"
                 Variant="Variant.Outlined"
                 Min="1" Max="3600"
                 Class="mt-4" />

@if (Server.ServerType == ServerType.Ollama)
{
    <MudSwitch @bind-Value="Server.IgnoreSslErrors" Class="mt-4">
        Ignore SSL certificate errors
    </MudSwitch>
}

@code {
    [Parameter] public LlmServerConfig Server { get; set; } = new();

    private string GetBaseUrlHelperText()
    {
        return Server.ServerType switch
        {
            ServerType.Ollama => "Ollama server URL (e.g., http://localhost:11434)",
            ServerType.ChatGpt => "Optional custom OpenAI API base URL (leave empty for default)",
            _ => ""
        };
    }
}
